# è¨­è¨ˆæ¡ˆ: AIå¿œå‹Ÿé©åˆåº¦ãƒã‚§ãƒƒã‚«ãƒ¼æ”¹å–„

## ç¾çŠ¶åˆ†æž

### æ—¢å­˜å®Ÿè£…
- **F1**: æ±‚äººè¦ä»¶æŠ½å‡ºï¼ˆMust/Wantåˆ†é¡žæ¸ˆã¿ï¼‰
- **F2**: æ ¹æ‹ æŠ½å‡ºï¼ˆå¼•ç”¨æŠ½å‡ºã€RAGå¯¾å¿œæ¸ˆã¿ï¼‰
- **F3**: ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆmatch/gapåˆ¤å®šæ¸ˆã¿ï¼‰
- **F4**: æ”¹å–„æ¡ˆç”Ÿæˆ
- **F5**: é¢æŽ¥Q&Aç”Ÿæˆ
- **F6**: å“è³ªè©•ä¾¡ï¼ˆLLM-as-Judgeã€6è¦³ç‚¹è©•ä¾¡ï¼‰
- **UI**: å¼•ç”¨è¡¨ç¤ºã€å“è³ªè©•ä¾¡è¡¨ç¤º

### æ”¹å–„ãŒå¿…è¦ãªç‚¹
1. **æ ¹æ‹ è¡¨ç¤º**: match_levelã‚’æ˜Žç¢ºã«è¡¨ç¤ºï¼ˆmatch/partial/gapï¼‰
2. **Judgeè©•ä¾¡**: æ–°ã—ã„3è¦³ç‚¹è©•ä¾¡ï¼ˆç´å¾—æ„Ÿ/æ ¹æ‹ ã®å¦¥å½“æ€§/èª‡å¼µæŠ‘åˆ¶ï¼‰ã‚’è¿½åŠ 
3. **ã‚³ã‚¹ãƒˆæœ€é©åŒ–**: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåœ§ç¸®ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½
4. **ä¾‹å¤–å‡¦ç†**: å…¥åŠ›æ¤œè¨¼ã€JSONãƒ‘ãƒ¼ã‚¹å¤±æ•—æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¼·åŒ–

## å®Ÿè£…è¨­è¨ˆ

### A. æ ¹æ‹ è¡¨ç¤ºï¼ˆå¼•ç”¨ï¼‰ã®æ”¹å–„

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
- **æ–°è¦**: `ui_components.py` - UIè¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **ä¿®æ­£**: `app.py` - `_render_single_result()`ã‚’æ”¹å–„
- **ä¿®æ­£**: `models.py` - `MatchLevel` Enumè¿½åŠ ï¼ˆæ—¢å­˜ã®`ConfidenceLevel`ã‚’æ‹¡å¼µï¼‰

#### å®Ÿè£…å†…å®¹
1. **`models.py`ã«`MatchLevel` Enumè¿½åŠ **
   ```python
   class MatchLevel(str, Enum):
       MATCH = "match"      # å®Œå…¨ä¸€è‡´ï¼ˆconfidence >= 0.7ï¼‰
       PARTIAL = "partial"  # éƒ¨åˆ†ä¸€è‡´ï¼ˆ0.4 <= confidence < 0.7ï¼‰
       GAP = "gap"          # ã‚®ãƒ£ãƒƒãƒ—ï¼ˆconfidence < 0.4 ã¾ãŸã¯å¼•ç”¨ãªã—ï¼‰
   ```

2. **`ui_components.py`ã«æ ¹æ‹ è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¿½åŠ **
   - `render_requirement_with_evidence()`: è¦ä»¶ã¨å¼•ç”¨ã‚’ã‚»ãƒƒãƒˆã§è¡¨ç¤º
   - Must/Wantã‚’ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ†ã‘
   - match_levelã«å¿œã˜ãŸè‰²/ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º
   - gapã®å ´åˆã¯ä¸è¶³ç†ç”±ã‚’è¡¨ç¤º

3. **`app.py`ã®`_render_single_result()`ã‚’ä¿®æ­£**
   - æ–°ã—ã„UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨
   - Must/Wantã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ†ã‘

### B. Judgeè©•ä¾¡ãƒ«ãƒ¼ãƒ—ï¼ˆæ–°ã—ã„3è¦³ç‚¹è©•ä¾¡ï¼‰

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
- **æ–°è¦**: `f7_judge_evaluation.py` - æ–°ã—ã„Judgeè©•ä¾¡ï¼ˆ3è¦³ç‚¹ï¼‰
- **ä¿®æ­£**: `models.py` - `JudgeEvaluation`ãƒ¢ãƒ‡ãƒ«è¿½åŠ 
- **ä¿®æ­£**: `app.py` - Judgeè©•ä¾¡çµæžœã‚’è¡¨ç¤º

#### å®Ÿè£…å†…å®¹
1. **`models.py`ã«`JudgeEvaluation`ãƒ¢ãƒ‡ãƒ«è¿½åŠ **
   ```python
   class JudgeScore(BaseModel):
       convincing: float = Field(..., ge=0.0, le=100.0)  # ç´å¾—æ„Ÿ
       grounding: float = Field(..., ge=0.0, le=100.0)   # æ ¹æ‹ ã®å¦¥å½“æ€§
       no_exaggeration: float = Field(..., ge=0.0, le=100.0)  # èª‡å¼µæŠ‘åˆ¶
   
   class JudgeEvaluation(BaseModel):
       scores: JudgeScore
       issues: List[str]  # å•é¡Œç‚¹
       fix_suggestions: List[str]  # æ”¹å–„ææ¡ˆ
   ```

2. **`f7_judge_evaluation.py`ã‚’æ–°è¦ä½œæˆ**
   - `evaluate_with_judge()`é–¢æ•°
   - æ—¢å­˜F6ã¨ã¯åˆ¥ã®è©•ä¾¡è¦³ç‚¹ã§è©•ä¾¡
   - miniãƒ¢ãƒ‡ãƒ«ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«

3. **`app.py`ã«Judgeè©•ä¾¡çµæžœè¡¨ç¤ºã‚’è¿½åŠ **
   - ã€ŒðŸ“Š Judgeè©•ä¾¡çµæžœã€ã‚«ãƒ¼ãƒ‰
   - 3è¦³ç‚¹ã®ã‚¹ã‚³ã‚¢è¡¨ç¤º
   - æ”¹å–„ææ¡ˆã‚’è¡¨ç¤º

### C. ã‚³ã‚¹ãƒˆæœ€é©åŒ–

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
- **æ–°è¦**: `cost_optimizer.py` - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåœ§ç¸®ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†
- **ä¿®æ­£**: `f1_extract_requirements.py` - ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾å¿œ
- **ä¿®æ­£**: `f2_extract_evidence.py` - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåœ§ç¸®ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾å¿œ
- **ä¿®æ­£**: `app.py` - ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ãƒ¢ãƒ‡ãƒ«é¸æŠžUIè¿½åŠ 

#### å®Ÿè£…å†…å®¹
1. **`cost_optimizer.py`ã‚’æ–°è¦ä½œæˆ**
   - `compress_text()`: ãƒ†ã‚­ã‚¹ãƒˆåœ§ç¸®ï¼ˆé•·ã„å ´åˆã¯å…ˆé ­æœ«å°¾ã®è¦ç‚¹ã‚’æ®‹ã™ï¼‰
   - `limit_candidate_sentences()`: å€™è£œæ–‡ã‚’ä¸Šé™Nä»¶ã«çµžã‚‹
   - `get_cache_key()`: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ç”Ÿæˆï¼ˆå…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã®ãƒãƒƒã‚·ãƒ¥ï¼‰

2. **Streamlitã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½**
   - `@st.cache_data`: è¦ä»¶æŠ½å‡ºçµæžœã€å€™è£œæ–‡åˆ†å‰²çµæžœ
   - `@st.cache_resource`: LLMã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

3. **ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåœ§ç¸®**
   - è·å‹™çµŒæ­´ãŒé•·ã„å ´åˆï¼ˆä¾‹: 5000æ–‡å­—è¶…ï¼‰ã€å€™è£œæ–‡ã‚’30ä»¶ã«åˆ¶é™
   - 1æ–‡ãŒé•·ã„å ´åˆï¼ˆä¾‹: 200æ–‡å­—è¶…ï¼‰ã€å…ˆé ­æœ«å°¾ã®è¦ç‚¹ã‚’æ®‹ã—ã¦çŸ­ç¸®

4. **ãƒ¢ãƒ‡ãƒ«é¸æŠžUI**
   - ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã€Œãƒ¢ãƒ‡ãƒ«é¸æŠžã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ 
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: miniãƒ¢ãƒ‡ãƒ«
   - ã‚ªãƒ—ã‚·ãƒ§ãƒ³: ä¸Šä½ãƒ¢ãƒ‡ãƒ«ã«åˆ‡ã‚Šæ›¿ãˆå¯èƒ½

### D. ä¾‹å¤–å‡¦ç†ï¼ˆã‚¬ãƒ¼ãƒ‰ï¼‰

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
- **æ–°è¦**: `input_validator.py` - å…¥åŠ›æ¤œè¨¼
- **ä¿®æ­£**: å„F1-F7é–¢æ•° - JSONãƒ‘ãƒ¼ã‚¹å¤±æ•—æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¼·åŒ–
- **ä¿®æ­£**: `app.py` - å…¥åŠ›æ¤œè¨¼çµæžœã‚’è¡¨ç¤º

#### å®Ÿè£…å†…å®¹
1. **`input_validator.py`ã‚’æ–°è¦ä½œæˆ**
   - `validate_job_text()`: æ±‚äººç¥¨ã®æ¤œè¨¼ï¼ˆ300æ–‡å­—æœªæº€ã§ã‚¨ãƒ©ãƒ¼ï¼‰
   - `validate_resume_text()`: è·å‹™çµŒæ­´ã®æ¤œè¨¼ï¼ˆ200æ–‡å­—æœªæº€ã§ã‚¨ãƒ©ãƒ¼ï¼‰
   - `validate_requirements_extracted()`: è¦ä»¶æŠ½å‡ºçµæžœã®æ¤œè¨¼ï¼ˆ0ä»¶ã§ã‚¨ãƒ©ãƒ¼ï¼‰
   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™ï¼ˆæ¬¡ã®å…¥åŠ›æŒ‡ç¤ºï¼‰

2. **JSONãƒ‘ãƒ¼ã‚¹å¤±æ•—æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¼·åŒ–**
   - æ—¢å­˜ã®`RetryWithErrorOutputParser`ã‚’æ´»ç”¨
   - ãƒªãƒˆãƒ©ã‚¤1å›žï¼ˆtemperatureä½Žã‚ï¼‰
   - ãã‚Œã§ã‚‚ãƒ€ãƒ¡ãªã‚‰ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãƒ†ã‚­ã‚¹ãƒˆæ•´å½¢ã—ã¦è¡¨ç¤ºã—ã€Œè§£æžå¤±æ•—ã€ã‚’æ˜Žç¤º

3. **`app.py`ã«å…¥åŠ›æ¤œè¨¼ã‚’çµ±åˆ**
   - åˆ†æžå®Ÿè¡Œå‰ã«æ¤œè¨¼
   - ã‚¨ãƒ©ãƒ¼æ™‚ã¯`st.error`ã§è¡¨ç¤ºã—ã€å‡¦ç†ã‚’åœæ­¢

## å®Ÿè£…é †åº

1. **D. ä¾‹å¤–å‡¦ç†** - æœ€åˆã«å®Ÿè£…ï¼ˆå®‰å…¨æ€§ç¢ºä¿ï¼‰
2. **A. æ ¹æ‹ è¡¨ç¤ºæ”¹å–„** - UIæ”¹å–„
3. **C. ã‚³ã‚¹ãƒˆæœ€é©åŒ–** - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æ”¹å–„
4. **B. Judgeè©•ä¾¡ãƒ«ãƒ¼ãƒ—** - æ–°æ©Ÿèƒ½è¿½åŠ 

## ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«
- `ui_components.py` - UIè¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- `f7_judge_evaluation.py` - Judgeè©•ä¾¡ï¼ˆ3è¦³ç‚¹ï¼‰
- `cost_optimizer.py` - ã‚³ã‚¹ãƒˆæœ€é©åŒ–ï¼ˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåœ§ç¸®ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰
- `input_validator.py` - å…¥åŠ›æ¤œè¨¼

### ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«
- `models.py` - `MatchLevel` Enumã€`JudgeEvaluation`ãƒ¢ãƒ‡ãƒ«è¿½åŠ 
- `app.py` - UIæ”¹å–„ã€Judgeè©•ä¾¡è¡¨ç¤ºã€å…¥åŠ›æ¤œè¨¼çµ±åˆ
- `f1_extract_requirements.py` - ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾å¿œ
- `f2_extract_evidence.py` - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåœ§ç¸®ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾å¿œ

### ä¾å­˜é–¢ä¿‚
- æ—¢å­˜ã®ä¾å­˜é–¢ä¿‚ã‚’ç¶­æŒ
- è¿½åŠ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã—ï¼ˆStreamlitã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã‚’ä½¿ç”¨ï¼‰

## æ³¨æ„äº‹é …

1. **æ—¢å­˜æ©Ÿèƒ½ã®ç ´å£Šçš„å¤‰æ›´ã‚’é¿ã‘ã‚‹**
   - æ—¢å­˜ã®F1-F6ã¯ãã®ã¾ã¾ç¶­æŒ
   - æ–°ã—ã„æ©Ÿèƒ½ã¯è¿½åŠ ã¨ã—ã¦å®Ÿè£…

2. **å¾Œæ–¹äº’æ›æ€§**
   - æ—¢å­˜ã®`ConfidenceLevel`ã¯ç¶­æŒ
   - æ–°ã—ã„`MatchLevel`ã¯æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¤‰æ›å¯èƒ½

3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹**
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã§APIã‚³ã‚¹ãƒˆã¨é…å»¶ã‚’å‰Šæ¸›
   - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåœ§ç¸®ã§ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã‚’å‰Šæ¸›


