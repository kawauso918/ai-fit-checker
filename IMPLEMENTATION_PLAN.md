# 実装計画: 改善ポイント1-4

## 現状分析

### 既存実装
- `input_validator.py`: 求人票の最低文字数チェック（300文字未満でエラー）
- `app.py`: 入力フォーム、分析実行、結果表示
- `run_analysis_core()`: F1-F7の処理を実行
- F1-F5: 既存の分析処理モジュール

## 変更が必要なファイルと実装順

### 1. 求人票の最低文字数チェック撤廃

#### 変更ファイル
- `input_validator.py`
  - `validate_job_text()`: 300文字未満のチェックを削除し、警告のみ返す関数を追加
- `app.py`
  - 入力検証後の警告表示を追加（`st.warning`）

#### 実装内容
- 空の場合のみエラー
- 短い場合（300文字未満）は警告に留める
- 警告は処理を停止せず、分析を続行可能

---

### 2. 企業情報入力欄追加

#### 変更ファイル
- `app.py`
  - 企業情報入力欄を追加（expander内）
  - `run_analysis_core()`に`company_info`パラメータを追加
- `f1_extract_requirements.py`（必要に応じて）
  - 企業情報を考慮した要件抽出（オプション）

#### 実装内容
- 企業情報入力欄を追加（会社概要/採用ページ全体など）
- 企業情報はオプション（空でもOK）
- F1で企業情報も考慮するように拡張（必要に応じて）

---

### 3. 応募メール文面生成

#### 新規ファイル
- `f8_generate_application_email.py`
  - 応募メール文面生成関数
  - Pydanticモデルで出力形式を定義

#### 変更ファイル
- `models.py`
  - `ApplicationEmail`モデルを追加
- `app.py`
  - `run_analysis_core()`にF8を追加
  - 応募メール文面表示セクションを追加

#### 実装内容
- 求人票、職務経歴書、分析結果から応募メール文面を生成
- 件名、本文、添付資料の提案を含む
- 企業情報がある場合は企業文化に合わせた文面を生成

---

### 4. チャット機能

#### 新規ファイル
- `chat_interface.py`
  - チャット機能の実装
  - 求人内容の深掘り考察
  - 応募文面改善の提案

#### 変更ファイル
- `app.py`
  - チャットインターフェースを追加（expanderまたはタブ）
  - チャット履歴を管理

#### 実装内容
- チャットで求人内容を深掘り考察
- 募集内容理解の質問に回答
- 応募文面改善の提案
- チャット履歴を保持（session_state）

---

## 実装順序

1. **改善1**: 求人票の最低文字数チェック撤廃
2. **改善2**: 企業情報入力欄追加
3. **改善3**: 応募メール文面生成
4. **改善4**: チャット機能

---

## 技術方針

- **UI**: 1ページ（入力→結果）を維持
- **既存構造**: F1-F5構造は崩さない（新規モジュール追加）
- **Pydantic**: 既存のPydantic + RetryWithErrorOutputParser方針を維持
- **README**: 各機能追加ごとに更新









